# =================================================================
# Cấu hình Hệ thống AIOps Engine
# =================================================================

# URL của hệ thống Prometheus để lấy dữ liệu metric
PROM_URL=http://your-prometheus-ip:9090

# URL của Alertmanager để gửi các cảnh báo khi phát hiện bất thường
ALERTMANAGER_URL=http://your-alertmanager-ip:9093

# Câu lệnh truy vấn PromQL để AI giám sát. Bạn có thể theo dõi một hoặc nhiều chỉ số cùng lúc.
# Ví dụ:
# 1. Chỉ theo dõi Sống/Chết: up
# 2. Theo dõi CPU: 100 - (avg by (instance) (irate(node_cpu_seconds_total{mode="idle"}[5m])) * 100)
# 3. Theo dõi RAM: (node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes * 100
# 4. Theo dõi nhiều chỉ số (dùng regex): {__name__=~"up|node_cpu_seconds_total|node_memory_MemAvailable_bytes"}
PROM_QUERY=up

# Bỏ qua xác thực SSL nếu dùng HTTPS với chứng chỉ tự ký (self-signed)
PROM_SKIP_SSL=false
AM_SKIP_SSL=false

# Direct Alerts (Telegram)
TELEGRAM_ENABLED=false
TELEGRAM_BOT_TOKEN=your_bot_token_here
TELEGRAM_CHAT_ID=your_chat_id_here

# Direct Alerts (Email)
EMAIL_ENABLED=false
EMAIL_RECIPIENTS=admin1@example.com,admin2@yahoo.com
SMTP_FROM=bot@domain.com
SMTP_SMARTHOST=smtp.gmail.com:587
SMTP_AUTH_USERNAME=bot@domain.com
SMTP_AUTH_PASSWORD=pass

# Khoảng thời gian (phút) lặp lại cảnh báo nếu lỗi vẫn tiếp diễn (60 phút = 1h). Đặt 0 để tắt repeat.
ALERT_REPEAT_INTERVAL_MINUTES=60

# Khoảng thời gian (giờ) dữ liệu quá khứ mà AI sẽ lấy để học tập và phân tích
# Giá trị 720 tương đương với 30 ngày (1 tháng) dữ liệu
LOOKBACK_HOURS=720

# How often to run the anomaly detection (in minutes)
CHECK_INTERVAL_MINUTES=1

# Độ nhạy của thuật toán (Contamination): tỉ lệ các điểm dữ liệu được coi là bất thường trong tập huấn luyện.
# Thường nằm trong khoảng 0.01 (ít nhạy) đến 0.1 (rất nhạy). Mặc định 0.05.
CONTAMINATION=0.05

# =================================================================
# Cấu hình Auto-Discovery (Tự động phát hiện Metric)
# =================================================================

# Bật/Tắt tính năng tự động phát hiện metric từ Prometheus
METRIC_DISCOVERY_ENABLED=true

# Regex Pattern để lọc các metric cần monitor.
# Mặc định lấy các chỉ số quan trọng của Node Exporter: Sống/Chết, CPU, RAM, Disk, Network
METRIC_DISCOVERY_PATTERN=^(up|node_cpu_seconds_total|node_memory_.*|node_filesystem_.*|node_network_.*)$

# Số luồng xử lý song song (Tăng tốc độ xử lý khi có nhiều metric)
MAX_WORKERS=10
ANALYSIS_WINDOW_HOURS=168

# =================================================================
# Cấu hình Hạ tầng Database (PostgreSQL 16 + pgvector)
# =================================================================

# Tên người dùng quản trị Database (Được Docker dùng để khởi tạo)
POSTGRES_USER=postgres

# Mật khẩu quản trị Database (Docker dùng để khởi tạo, App dùng để kết nối)
# LƯU Ý: Nếu đổi pass ở đây, phải cập nhật cả mật khẩu trong DATABASE_URL bên dưới
POSTGRES_PASSWORD=your_secure_password_here

# Tên Database chính của ứng dụng
POSTGRES_DB=aiops

# Chuỗi kết nối (Connection String) đầy đủ cho ứng dụng Python
# Định dạng: postgresql://<user>:<password>@<host>:<port>/<db_name>
# Lưu ý: 'postgres' ở phần host là tên service trong docker-compose
DATABASE_URL=postgresql://postgres:your_secure_password_here@postgres:5432/aiops
